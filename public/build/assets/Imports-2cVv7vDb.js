import{d as E,b as n,k,o as r,w as u,h as i,a as s,u as d,i as N,q as L,c,s as b,v as S,j as h,F as j,l as P,t as g,x as G,T as K,y as O,n as U,p as H}from"./app-a6UwzxQE.js";import{A as J}from"./AppLayout-C2AZoFya.js";import{_ as Q}from"./HeadingSmall.vue_vue_type_script_setup_true_lang-Cq233JUb.js";import{_ as I,a as M}from"./Label.vue_vue_type_script_setup_true_lang-CkY80-7z.js";import{_ as F}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CiPMHzJc.js";import{_ as R}from"./Input.vue_vue_type_script_setup_true_lang-BW6J9HH-.js";import"./useForwardExpose-B_yTRxSi.js";import"./RovingFocusGroup-DdkT5O_F.js";const W={class:"flex flex-col space-y-6 max-w-2xl mx-auto"},X={class:"grid gap-2"},Y=["value"],Z={class:"grid gap-2"},ee={class:"flex items-center gap-4"},se={key:0,class:"flex items-center gap-2 text-sm text-muted-foreground"},ae={class:"text-xs"},te={class:"flex items-center gap-4"},oe={key:0},le={key:1,class:"animate-spin"},re={class:"ml-2"},ie={class:"text-sm text-green-600"},ne={key:0,class:"mt-4"},ue={class:"flex items-center gap-2"},de={key:0},ce={key:1},he=E({__name:"Imports",setup(me){const q=[{title:"Importa√ß√µes",href:"/imports"}],m=n(""),t=n(null),p=n(!1),v=n(""),x=n("success"),y=n(!1),o=n({}),T=[{label:"Campanhas",value:"campanhas"}],z=a=>{const e=a.target;e.files&&e.files[0]&&(t.value=e.files[0],o.value.file="")},w=()=>{t.value=null;const a=document.getElementById("file");a&&(a.value="")},B=()=>{m.value="",w(),v.value="",o.value={}},A=a=>{if(a===0)return"0 Bytes";const e=1024,l=["Bytes","KB","MB","GB"],f=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,f)).toFixed(2))+" "+l[f]},V=()=>(o.value={},m.value||(o.value.type="Selecione um tipo de importa√ß√£o"),t.value?t.value.size>10*1024*1024&&(o.value.file="Arquivo muito grande (m√°ximo 10MB)"):o.value.file="Selecione um arquivo",Object.keys(o.value).length===0),$=async()=>{var e,l,f,C;if(!V())return;p.value=!0,v.value="",y.value=!1;const a=new FormData;a.append("type",m.value),a.append("file",t.value);try{const _=await H.post("/imports/process",a,{headers:{"Content-Type":"multipart/form-data"}});v.value=_.data.message||"Planilha importada com sucesso!",x.value="success",y.value=!0,setTimeout(()=>{B(),y.value=!1},3e3)}catch(_){const D=((l=(e=_.response)==null?void 0:e.data)==null?void 0:l.message)||"Erro ao importar planilha.";v.value=D,x.value="error",(C=(f=_.response)==null?void 0:f.data)!=null&&C.errors&&(o.value=_.response.data.errors)}finally{p.value=!1}};return(a,e)=>(r(),k(J,{breadcrumbs:q},{default:u(()=>[i(d(N),{title:"Importa√ß√µes"}),s("div",W,[i(Q,{title:"Importar Planilha",description:"Fa√ßa upload de arquivos para importar dados no sistema"}),s("form",{onSubmit:L($,["prevent"]),class:"space-y-6"},[s("div",X,[i(d(I),{for:"type"},{default:u(()=>e[1]||(e[1]=[h("Tipo de Importa√ß√£o")])),_:1,__:[1]}),S(s("select",{id:"type","onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l),class:"flex h-9 w-full rounded-md border border-input bg-background px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",required:""},[e[2]||(e[2]=s("option",{value:"",disabled:""},"Selecione o tipo de importa√ß√£o",-1)),(r(),c(j,null,P(T,l=>s("option",{key:l.value,value:l.value},g(l.label),9,Y)),64))],512),[[G,m.value]]),i(M,{class:"mt-2",message:o.value.type},null,8,["message"])]),s("div",Z,[i(d(I),{for:"file"},{default:u(()=>e[3]||(e[3]=[h("Arquivo")])),_:1,__:[3]}),s("div",ee,[i(d(R),{id:"file",type:"file",accept:".xlsx,.csv",onChange:z,class:"flex-1",required:""}),t.value?(r(),k(d(F),{key:0,type:"button",variant:"outline",size:"sm",onClick:w},{default:u(()=>e[4]||(e[4]=[h(" ‚úï ")])),_:1,__:[4]})):b("",!0)]),t.value?(r(),c("div",se,[e[5]||(e[5]=s("span",null,"üìÑ",-1)),s("span",null,g(t.value.name),1),s("span",ae,"("+g(A(t.value.size))+")",1)])):b("",!0),i(M,{class:"mt-2",message:o.value.file},null,8,["message"])]),s("div",te,[i(d(F),{disabled:p.value,type:"submit"},{default:u(()=>[p.value?(r(),c("span",le,"‚è≥")):(r(),c("span",oe,"üì§")),s("span",re,g(p.value?"Importando...":"Importar"),1)]),_:1},8,["disabled"]),t.value||m.value?(r(),k(d(F),{key:0,type:"button",variant:"outline",onClick:B,disabled:p.value},{default:u(()=>e[6]||(e[6]=[h(" Limpar ")])),_:1,__:[6]},8,["disabled"])):b("",!0),i(K,{"enter-active-class":"transition ease-in-out","enter-from-class":"opacity-0","leave-active-class":"transition ease-in-out","leave-to-class":"opacity-0"},{default:u(()=>[S(s("p",ie," Importa√ß√£o realizada com sucesso! ",512),[[O,y.value]])]),_:1})]),v.value?(r(),c("div",ne,[s("div",{class:U(["rounded-lg p-4 text-sm",x.value==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"])},[s("div",ue,[x.value==="success"?(r(),c("span",de,"‚úÖ")):(r(),c("span",ce,"‚ö†Ô∏è")),s("span",null,g(v.value),1)])],2)])):b("",!0)],32),e[7]||(e[7]=s("div",{class:"rounded-lg border border-border p-4 bg-muted/50"},[s("h4",{class:"font-medium mb-2"},"Formatos aceitos"),s("ul",{class:"text-sm text-muted-foreground space-y-1"},[s("li",null,"‚Ä¢ Arquivos Excel (.xlsx)"),s("li",null,"‚Ä¢ Arquivos CSV (.csv)"),s("li",null,"‚Ä¢ Tamanho m√°ximo: 10MB")])],-1))])]),_:1}))}});export{he as default};
