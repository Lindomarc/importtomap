import{d as C,c as _,o as u,a as x,r as z,n as T,u as t,b as K,e as R,f as I,g as F,h as a,i as J,w as s,j as o,k as L,F as D,l as U,t as m,m as P,p as H}from"./app-a6UwzxQE.js";import{A as O}from"./AppLayout-C2AZoFya.js";import{c as V,_ as g}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CiPMHzJc.js";import{_ as X}from"./Input.vue_vue_type_script_setup_true_lang-BW6J9HH-.js";import"./useForwardExpose-B_yTRxSi.js";import"./RovingFocusGroup-DdkT5O_F.js";const Q={"data-slot":"table-container",class:"relative w-full overflow-auto"},W=C({__name:"Table",props:{class:{}},setup(f){const i=f;return(l,p)=>(u(),_("div",Q,[x("table",{"data-slot":"table",class:T(t(V)("w-full caption-bottom text-sm",i.class))},[z(l.$slots,"default")],2)]))}}),Y=C({__name:"TableBody",props:{class:{}},setup(f){const i=f;return(l,p)=>(u(),_("tbody",{"data-slot":"table-body",class:T(t(V)("[&_tr:last-child]:border-0",i.class))},[z(l.$slots,"default")],2))}}),b=C({__name:"TableCell",props:{class:{}},setup(f){const i=f;return(l,p)=>(u(),_("td",{"data-slot":"table-cell",class:T(t(V)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",i.class))},[z(l.$slots,"default")],2))}}),j=C({__name:"TableRow",props:{class:{}},setup(f){const i=f;return(l,p)=>(u(),_("tr",{"data-slot":"table-row",class:T(t(V)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",i.class))},[z(l.$slots,"default")],2))}}),k=C({__name:"TableHead",props:{class:{}},setup(f){const i=f;return(l,p)=>(u(),_("th",{"data-slot":"table-head",class:T(t(V)("text-muted-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",i.class))},[z(l.$slots,"default")],2))}}),Z=C({__name:"TableHeader",props:{class:{}},setup(f){const i=f;return(l,p)=>(u(),_("thead",{"data-slot":"table-header",class:T(t(V)("[&_tr]:border-b",i.class))},[z(l.$slots,"default")],2))}}),ee={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto"},te={class:"container mx-auto p-4"},ae={key:0,class:"flex items-center gap-2"},le=["onClick"],se={key:0,class:"flex items-center gap-2"},ne=["onClick"],oe={class:"flex items-center justify-between mt-4"},re={class:"text-sm text-gray-600"},ue={class:"flex items-center gap-2"},ve=C({__name:"Campanhas",setup(f){const i=[{title:"Campanhas",href:"/campanhas"}],l=K({data:[],current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),p=K(!1),w=K(null),y=K(""),S=(r,e,d)=>{w.value={id:r,field:e},y.value=d||""},E=()=>{w.value=null,y.value=""},B=async(r,e)=>{try{p.value=!0,await H.put(`/api/campanhas/${r}`,{[e]:y.value});const d=l.value.data.find(v=>v.id===r);d&&(d[e]=y.value),E()}catch(d){console.error(`Erro ao atualizar ${e}:`,d)}finally{p.value=!1}},q=async r=>{if(confirm("Tem certeza que deseja deletar esta campanha?"))try{p.value=!0,await H.delete(`/api/campanhas/${r}`),l.value.data=l.value.data.filter(e=>e.id!==r),l.value.total--,l.value.data.length===0&&l.value.current_page>1&&A(l.value.current_page-1,l.value.per_page)}catch(e){console.error("Erro ao deletar campanha:",e),alert("Erro ao deletar campanha. Tente novamente.")}finally{p.value=!1}},A=async(r=1,e=10)=>{try{p.value=!0;const d=await H.get(`/api/campanhas?page=${r}&per_page=${e}`);l.value=d.data}catch(d){console.error("Erro ao buscar campanhas:",d)}finally{p.value=!1}},M=r=>{r>=1&&r<=l.value.last_page&&A(r,l.value.per_page)},G=R(()=>{const r=[],e=l.value.current_page,d=l.value.last_page;let v=Math.max(1,e-2),h=Math.min(d,e+2);h-v<4&&(v===1?h=Math.min(d,v+4):v=Math.max(1,h-4));for(let n=v;n<=h;n++)r.push(n);return r});return I(()=>{A()}),(r,e)=>{const d=F("Check"),v=F("X"),h=F("Trash2");return u(),_(D,null,[a(t(J),{title:"Campanhas"}),a(O,{breadcrumbs:i},{default:s(()=>[x("div",ee,[x("div",te,[a(t(W),null,{default:s(()=>[a(t(Z),null,{default:s(()=>[a(t(j),null,{default:s(()=>[a(t(k),null,{default:s(()=>e[10]||(e[10]=[o("Campanha")])),_:1,__:[10]}),a(t(k),null,{default:s(()=>e[11]||(e[11]=[o("Cliente")])),_:1,__:[11]}),a(t(k),null,{default:s(()=>e[12]||(e[12]=[o("Veículo")])),_:1,__:[12]}),a(t(k),null,{default:s(()=>e[13]||(e[13]=[o("Meio")])),_:1,__:[13]}),a(t(k),null,{default:s(()=>e[14]||(e[14]=[o("Praça")])),_:1,__:[14]}),a(t(k),null,{default:s(()=>e[15]||(e[15]=[o("LAT")])),_:1,__:[15]}),a(t(k),null,{default:s(()=>e[16]||(e[16]=[o("LNG")])),_:1,__:[16]}),a(t(k),{class:"w-24"},{default:s(()=>e[17]||(e[17]=[o("Ações")])),_:1,__:[17]})]),_:1})]),_:1}),a(t(Y),null,{default:s(()=>[p.value?(u(),L(t(j),{key:0},{default:s(()=>[a(t(b),{colspan:"8",class:"text-center py-8"},{default:s(()=>e[18]||(e[18]=[x("div",{class:"flex items-center justify-center"},[x("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900"}),x("span",{class:"ml-2"},"Carregando...")],-1)])),_:1,__:[18]})]),_:1})):l.value.data.length===0?(u(),L(t(j),{key:1},{default:s(()=>[a(t(b),{colspan:"8",class:"text-center py-8"},{default:s(()=>e[19]||(e[19]=[o(" Nenhuma campanha encontrada ")])),_:1,__:[19]})]),_:1})):(u(!0),_(D,{key:2},U(l.value.data,n=>(u(),L(t(j),{key:n.id},{default:s(()=>[a(t(b),null,{default:s(()=>[o(m(n.campanha),1)]),_:2},1024),a(t(b),null,{default:s(()=>[o(m(n.cliente),1)]),_:2},1024),a(t(b),null,{default:s(()=>[o(m(n.veiculo),1)]),_:2},1024),a(t(b),null,{default:s(()=>[o(m(n.meio),1)]),_:2},1024),a(t(b),null,{default:s(()=>[o(m(n.praca),1)]),_:2},1024),a(t(b),null,{default:s(()=>{var $,N;return[(($=w.value)==null?void 0:$.id)===n.id&&((N=w.value)==null?void 0:N.field)==="lat"?(u(),_("div",ae,[a(t(X),{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=c=>y.value=c),type:"text",class:"h-8 w-24",onKeyup:[P(c=>B(n.id,"lat"),["enter"]),e[1]||(e[1]=P(c=>E(),["escape"]))]},null,8,["modelValue","onKeyup"]),a(t(g),{size:"sm",variant:"ghost",onClick:c=>B(n.id,"lat"),class:"h-8 w-8 p-0"},{default:s(()=>[a(d,{class:"h-4 w-4 text-green-600"})]),_:2},1032,["onClick"]),a(t(g),{size:"sm",variant:"ghost",onClick:e[2]||(e[2]=c=>E()),class:"h-8 w-8 p-0"},{default:s(()=>[a(v,{class:"h-4 w-4 text-red-600"})]),_:1})])):(u(),_("div",{key:1,class:"cursor-pointer hover:bg-gray-100 p-1 rounded",onClick:c=>S(n.id,"lat",n.lat)},m(n.lat||""),9,le))]}),_:2},1024),a(t(b),null,{default:s(()=>{var $,N;return[(($=w.value)==null?void 0:$.id)===n.id&&((N=w.value)==null?void 0:N.field)==="lng"?(u(),_("div",se,[a(t(X),{modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=c=>y.value=c),type:"text",class:"h-8 w-24",onKeyup:[P(c=>B(n.id,"lng"),["enter"]),e[4]||(e[4]=P(c=>E(),["escape"]))]},null,8,["modelValue","onKeyup"]),a(t(g),{size:"sm",variant:"ghost",onClick:c=>B(n.id,"lng"),class:"h-8 w-8 p-0"},{default:s(()=>[a(d,{class:"h-4 w-4 text-green-600"})]),_:2},1032,["onClick"]),a(t(g),{size:"sm",variant:"ghost",onClick:e[5]||(e[5]=c=>E()),class:"h-8 w-8 p-0"},{default:s(()=>[a(v,{class:"h-4 w-4 text-red-600"})]),_:1})])):(u(),_("div",{key:1,class:"cursor-pointer hover:bg-gray-100 p-1 rounded",onClick:c=>S(n.id,"lng",n.lng)},m(n.lng||""),9,ne))]}),_:2},1024),a(t(b),null,{default:s(()=>[a(t(g),{size:"sm",variant:"ghost",onClick:$=>q(n.id),class:"h-8 w-8 p-0 text-red-600 hover:text-red-800 hover:bg-red-50"},{default:s(()=>[a(h,{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),x("div",oe,[x("div",re," Página "+m(l.value.current_page)+" de "+m(l.value.last_page),1),x("div",ue,[a(t(g),{variant:"outline",size:"sm",disabled:l.value.current_page===1,onClick:e[6]||(e[6]=n=>M(1))},{default:s(()=>e[20]||(e[20]=[o(" «« ")])),_:1,__:[20]},8,["disabled"]),a(t(g),{variant:"outline",size:"sm",disabled:l.value.current_page===1,onClick:e[7]||(e[7]=n=>M(l.value.current_page-1))},{default:s(()=>e[21]||(e[21]=[o(" « ")])),_:1,__:[21]},8,["disabled"]),(u(!0),_(D,null,U(G.value,n=>(u(),L(t(g),{key:n,variant:n===l.value.current_page?"default":"outline",size:"sm",onClick:$=>M(n)},{default:s(()=>[o(m(n),1)]),_:2},1032,["variant","onClick"]))),128)),a(t(g),{variant:"outline",size:"sm",disabled:l.value.current_page===l.value.last_page,onClick:e[8]||(e[8]=n=>M(l.value.current_page+1))},{default:s(()=>e[22]||(e[22]=[o(" » ")])),_:1,__:[22]},8,["disabled"]),a(t(g),{variant:"outline",size:"sm",disabled:l.value.current_page===l.value.last_page,onClick:e[9]||(e[9]=n=>M(l.value.last_page))},{default:s(()=>e[23]||(e[23]=[o(" »» ")])),_:1,__:[23]},8,["disabled"])])])])])]),_:1})],64)}}});export{ve as default};
